<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!---- <script type="text/javascript" src="https://www.authpro.com/auth/NaboriCorp/?action=pp"></script>

    <a href="https://www.authpro.com/auth/NaboriCorp/?action=logout">Logout</a> -->

    <title>NABORI Corp - Student Portal</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css" rel="stylesheet">
    <style>
        :root {
            --primary-color: #2c3e50;
            --secondary-color: #3498db;
        }

        body {
            background-color: #fdfdfc;
            min-height: 100vh;
        }

        .navbar {
            box-shadow: 0 2px 4px rgba(0, 0, 0, .1);
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
        }

        main {
            margin-top: 80px;
            padding: 20px;
        }

        .section {
            display: none;
        }

        .section.active {
            display: block;
        }

        .exam-card {
            transition: transform 0.3s, box-shadow 0.3s;
            border: none;
            border-radius: 15px;
        }

        .question-card {
            background: white;
            border-radius: 10px;
            padding: 20px;
            margin-bottom: 20px;
            box-shadow: 0 2px 4px rgba(0, 0, 0, .1);
        }

        .timer {
            position: fixed;
            top: 70px;
            right: 20px;
            background: var(--secondary-color);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            z-index: 1000;
            display: none;
        }

        .correct-answer {
            background-color: #d4edda !important;
            border: 1px solid #c3e6cb !important;
        }

        .incorrect-answer {
            background-color: #f8d7da !important;
            border: 1px solid #f5c6cb !important;
        }

        .navbar-collapse {
            max-height: calc(100vh - 60px);
            overflow-y: auto;
        }

        /* Estilos del Chat Flotante */
        .chat-bubble {
            position: fixed;
            bottom: 40px;
            right: 30px;
            left: auto;
            z-index: 1000;
            cursor: pointer;
            transition: transform 0.3s ease;
        }

        .chat-bubble:hover {
            transform: scale(1.1);
        }

        .chat-bubble-icon {
            width: 60px;
            height: 60px;
            background:black;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 12px rgba(0, 0, 0, 0.2);
        }

        .chat-bubble-icon img {
            width: 90%;
            height: 90%;
        }

        .chat-container {
            position: fixed;
            bottom: 90px;
            right: 20px;
            left: auto;
            width: 350px;
            height: 550px;
            background: none;
            border-radius: 15px;
            box-shadow: none;
            display: none;
            flex-direction: column;
            z-index: 1000;
        }

        .chat-container.active {
            display: flex;
            animation: slideUp 0.3s ease;
        }

        [data-title]:hover:after {
            content: attr(data-title);
            position: absolute;
            bottom: 100%;
            left: 50%;
            transform: translateX(-50%);
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 6px 12px;
            border-radius: 4px;
            font-size: 0.8em;
            white-space: nowrap;
            margin-bottom: 8px;
            pointer-events: none;
        }

        @keyframes slideUp {
            from {
                transform: translateY(100px);
                opacity: 0;
            }

            to {
                transform: translateY(0);
                opacity: 1;
            }
        }

        .chat-header {
            background: #4CAF50;
            color: white;
            padding: 15px;
            border-radius: 15px 15px 0 0;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .chat-header h3 {
            margin: 0;
            font-size: 1.2em;
        }

        .close-btn {
            background: none;
            border: none;
            color: white;
            font-size: 1.5em;
            cursor: pointer;
        }

        .chat-body {
            flex: 1;
            padding: 15px;
            overflow-y: auto;
            background: #f8f9fa;
        }

        .chat-input {
            padding: 15px;
            border-top: 1px solid #ddd;
            background: white;
            border-radius: 0 0 15px 15px;
        }

        .chat-input input {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 20px;
            margin-bottom: 10px;
        }

        .chat-input button {
            width: 100%;
            padding: 10px;
            background: #4CAF50;
            color: white;
            border: none;
            border-radius: 20px;
            cursor: pointer;
        }

        .user-message,
        .bot-message {
            margin: 10px 0;
            padding: 10px 15px;
            border-radius: 15px;
            max-width: 80%;
            word-break: break-word;
            font-size: 0.9em;
        }

        .user-message {
            background: #e3f2fd;
            color: #1a73e8;
            margin-left: auto;
        }

        .bot-message {
            background: #f5f5f5;
            color: #0d652d;
            margin-right: auto;
        }

        @media (max-width: 480px) {
            .chat-container {
                width: 90vw;
                height: 70vh;
                right: 5vw;
                left: auto;
                bottom: 80px;
            }

            .chat-bubble {
                bottom: 10px;
                left: auto;
                right: 10px;
            }
        }

        @media (min-width: 992px) {
            .navbar-collapse {
                display: flex !important;
                flex-basis: auto;
            }
        }

        .btn-reset {
            position: relative;
            background: linear-gradient(135deg, #00b894 0%, #007a63 100%);
            border: none;
            border-radius: 12px;
            padding: 8px 20px;
            color: white;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 4px 15px rgba(0, 184, 148, 0.3);
            overflow: hidden;
            cursor: pointer;
        }

        .btn-reset::before {
            content: '';
            position: absolute;
            top: 0;
            left: -100%;
            width: 100%;
            height: 100%;
            background: linear-gradient(120deg,
                    transparent,
                    rgba(255, 255, 255, 0.3),
                    transparent);
            transition: 0.5s;
        }

        .btn-reset:hover {
            transform: translateY(-2px);
            box-shadow: 0 6px 20px rgba(0, 184, 148, 0.4);
        }

        .btn-reset:hover::before {
            left: 100%;
        }

        .btn-reset:active {
            transform: translateY(1px);
            box-shadow: 0 2px 10px rgba(0, 184, 148, 0.3);
        }

        .btn-reset i {
            margin-right: 8px;
            transition: transform 0.3s ease;
        }

        .btn-reset:hover i {
            transform: rotate(-45deg);
        }
img {
    max-width: 100px; /* Reduced from 300px for smaller size */
    width: auto; /* Changed from 100% to auto to maintain aspect ratio */
    height: auto;
    border-radius: 6px; /* Slightly reduced from 8px to match smaller size */
    box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    display: block; /* Ensures proper centering and spacing */
    margin: 10px auto; /* Centers the image and adds vertical spacing */
    object-fit: contain; /* Ensures image fits within dimensions while maintaining aspect ratio */
    min-width: 100px; /* Prevents images from becoming too small */
}

/* Add a class for even smaller images if needed */
.img-small {
    max-width: 100px;
}

        .modal-content {
            border-radius: 15px;
        }
        .modal-header {
            background-color: var(--secondary-color);
            color: white;
            border-top-left-radius: 15px;
            border-top-right-radius: 15px;
        }
        .modal-footer {
            border-top: none;
        }
       /* Estilo para el tooltip */
.tooltip {
    position: absolute;
    top: -30px; /* Posición arriba del chat bubble */
    left: -100px; /* Desplazado hacia la izquierda */
    background: transparent; /* Fondo transparente */
    color: blue; /* Texto azul */
    font-size: 14px;
    white-space: nowrap; /* Mantener el texto en una sola línea */
    opacity: 1; /* Visible por defecto */
    transition: opacity 0.5s ease-in-out; /* Transición suave */
    z-index: 1010; /* Asegurar que está por encima del chat bubble */
    pointer-events: none; /* Desactivar interacciones */
}

/* Ocultar el tooltip */
.tooltip.hidden {
    opacity: 0; /* Invisible cuando tiene la clase 'hidden' */
} 

    </style>
</head>

<body>
    <!-- Modal Inicial -->
    <div class="modal fade" id="welcomeModal" tabindex="-1" aria-labelledby="welcomeModalLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="welcomeModalLabel">Bienvenido a NABORI Corp College Board LMS</h5>
                </div>
                <div class="modal-body">
                    <p>En esta página tendrás la oportunidad de tomar exámenes diseñados al estilo del College Board para
                        práctica. Además, dispones de un modelo IA en el lado derecho inferior para consultas. Sin embargo,
                        el modelo no responderá preguntas de los exámenes, recordando que es para tu aprovechamiento.</p>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary" id="confirmAccess">Confirmar y Acceder</button>
                </div>
            </div>
        </div>
    </div>
    <!-- Navbar -->
    <nav class="navbar navbar-expand-lg navbar-dark bg-primary fixed-top">
        <div class="container">
            <a class="navbar-brand" href="#">NABORI Corp Smart College Board LMS</a>
            <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarNav">
                <span class="navbar-toggler-icon"></span>
            </button>
            <div class="collapse navbar-collapse" id="navbarNav">
                <ul class="navbar-nav ms-auto">
                    <li class="nav-item">
                        <a class="nav-link active" href="#dashboard"><i class="fas fa-home"></i> Dashboard</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#exams"><i class="fas fa-file-alt"></i> Exámenes</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" href="#grades"><i class="fas fa-chart-bar"></i> Calificaciones</a>
                    </li>
                </ul>
            </div>
        </div>
    </nav>

    <!-- Timer -->
    <div class="timer">00:00</div>

   <!--- Chat Bubble -->
<div class="chat-bubble" onclick="toggleChat()">
    <div class="chat-bubble-icon">
        <img src="https://static.wixstatic.com/media/af3a4a_f1f5c2a558c347919dc59d0ba2f23020~mv2.png" alt="Chat Icon">
    </div>
    <!-- Tooltip -->
    <div class="tooltip" id="tooltip">¡Hola! Soy Tutor Mathy!</div>
</div>
<!-- Coloca este código AL PRINCIPIO de tu script-->
<script>
    document.addEventListener('DOMContentLoaded', function () {
        const tooltip = document.getElementById('tooltip');

        if (tooltip) {
            // Esperar 3 segundos después de cargar la página
            setTimeout(() => {
                tooltip.classList.remove('hidden');

                // Ocultar después de 3 segundos más
                setTimeout(() => {
                    tooltip.classList.add('hidden');
                }, 3000);

            }, 3000);
        } else {
            console.error('Elemento tooltip no encontrado');
        }
    });
</script>


<!-- Chat Container -->
<div class="chat-container" id="chatContainer">
    <div class="chat-header">
        <h3>Tutor Mathy</h3>
        <button class="close-btn" onclick="toggleChat()">×</button>
    </div>
    <div class="chat-body" id="chatBody"></div>
    <div class="chat-input">
        <input type="text" id="userInput" placeholder="Escribe tu pregunta...">
        <button onclick="sendMessage()">Enviar</button>
    </div>
</div>

    <!-- Contenido Principal -->
    <main class="container-fluid">
        <!-- Dashboard -->
        <div class="container section active" id="dashboard">
            <h3 class="mb-4">Dashboard</h3>
            <div class="row">
                <div class="col-md-6 mb-4">
                    <div class="exam-card card bg-white p-4">
                        <h5><i class="fas fa-bell text-primary"></i> Próximos Exámenes</h5>
                        <ul class="list-group mt-3" id="upcoming-exams"></ul>
                    </div>
                </div>
                <div class="col-md-6 mb-4">
                    <div class="exam-card card bg-white p-4">
                        <h5><i class="fas fa-chart-line text-success"></i> Rendimiento</h5>
                        <canvas class="mt-3" id="performanceChart" width="400" height="200"></canvas>
                    </div>
                </div>
            </div>
        </div>

        <!-- Exam List -->
        <div class="container section" id="exams">
            <h3 class="mb-4">Exámenes Disponibles</h3>
            <div class="list-group" id="exam-list"></div>
        </div>

        <!-- Grades Section -->
        <div class="container section" id="grades">
            <h3 class="mb-4">Historial de Calificaciones</h3>
            <button class="btn btn-reset mb-3" onclick="resetAllExams()"
                data-title="Permite rehacer exámenes sin borrar calificaciones">
                <i class="fas fa-sync-alt"></i> Reiniciar Exámenes
            </button>
            <button class="btn btn-primary mb-3" onclick="generatePDF()">
                <i class="fas fa-download"></i> Exportar a PDF
            </button>
            <button class="btn btn-warning mb-3" onclick="clearGrades()">
                <i class="fas fa-trash-alt"></i> Limpiar Historial
            </button>

            <table class="table table-striped">
                <thead>
                    <tr>
                        <th>Examen</th>
                        <th>Calificación</th>
                        <th>Fecha</th>
                    </tr>
                </thead>
                <tbody id="grades-table"></tbody>
            </table>
        </div>
       

    </main>

    <!-- Exam Interface Modal -->
    <div class="modal fade" id="examModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="examTitle">Examen</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body" id="examQuestions"></div>
                <div class="modal-footer">
                    <button class="btn btn-primary" onclick="submitExam()">Entregar Examen</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Results Modal -->
    <div class="modal fade" id="resultsModal" tabindex="-1">
        <div class="modal-dialog modal-lg">
            <div class="modal-content">
                <div class="modal-header bg-primary text-white">
                    <h5 class="modal-title">Resultados del Examen</h5>
                    <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal"></button>
                </div>
                <div class="modal-body">
                    <h5 class="mb-3">Estudiante: <span id="studentName"></span></h5>
                    <h5>Resultado: <span id="finalScore"></span>%</h5>
                    <h6>Tiempo restante: <span id="timeUsed"></span></h6>
                    <hr>
                    <div id="resultsDetails"></div>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">Cerrar</button>
                </div>
            </div>
        </div>
    </div>

    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.5.25/jspdf.plugin.autotable.min.js"></script>


    <script>
        $(document).ready(function () {
            // Mostrar el modal al cargar la página
            $('#welcomeModal').modal({ backdrop: 'static', keyboard: false });
            $('#welcomeModal').modal('show');

            // Manejar la confirmación de acceso
            $('#confirmAccess').click(function () {
                $('#welcomeModal').modal('hide');
            });

            // Marcar como completado instantáneamente al tomar un examen
            $('.btn-exam').click(function () {
                const examId = $(this).data('exam-id');
                $(`#exam-status-${examId}`).html('<span class="text-success"><i class="fas fa-check"></i> Completado</span>');
            });
        });
    </script>

    <script>
        
        function resetAllExams() {
            if (!confirm('¿Reiniciar todos los exámenes? Podrás volver a realizarlos pero se conservará tu historial.')) return;

            // Solo reiniciamos el estado de los exámenes
            exams = exams.map(exam => ({ ...exam, status: "pending" }));

            // Actualizamos el localStorage manteniendo las calificaciones
            const progressData = {
                grades: grades.map(grade => ({ ...grade })),
                completedExams: [],
                ip: localStorage.getItem('studentProgress')?.ip || '',
                timestamp: new Date().toISOString()
            };

            localStorage.setItem('studentProgress', JSON.stringify(progressData));

            // Actualizamos UI
            loadExams();
            initDashboard();

            alert('Exámenes reiniciados. Tu historial sigue disponible.');
        }
        // Código del Chat Bot
           const _0x517fd8 = _0x43bf; (function (_0x411665, _0x10ed3a) { const _0x5b53ab = _0x43bf, _0xf69711 = _0x411665(); while (!![]) { try { const _0x528b2b = -parseInt(_0x5b53ab(0xe7)) / 0x1 * (parseInt(_0x5b53ab(0xce)) / 0x2) + -parseInt(_0x5b53ab(0xf7)) / 0x3 * (-parseInt(_0x5b53ab(0xc6)) / 0x4) + parseInt(_0x5b53ab(0xd7)) / 0x5 * (-parseInt(_0x5b53ab(0xef)) / 0x6) + -parseInt(_0x5b53ab(0xd5)) / 0x7 + -parseInt(_0x5b53ab(0xf3)) / 0x8 + parseInt(_0x5b53ab(0xf0)) / 0x9 * (parseInt(_0x5b53ab(0xca)) / 0xa) + parseInt(_0x5b53ab(0xe0)) / 0xb; if (_0x528b2b === _0x10ed3a) break; else _0xf69711['push'](_0xf69711['shift']()); } catch (_0x1ff327) { _0xf69711['push'](_0xf69711['shift']()); } } }(_0x373c, 0x58d98)); const API_KEY = _0x517fd8(0xf8), API_URL = _0x517fd8(0xe9); let conversationHistory = [], isProcessing = ![]; function _0x373c() { const _0x2d9ec4 = ['Error:', '112498zIHrND', 'includes', 'https://generativelanguage.googleapis.com/v1beta/models/gemini-1.5-flash-latest:generateContent', 'active', 'Repetir', 'replace', 'push', 'toLowerCase', '570wQNRCW', '9GLSsXL', 'De\x20nuevo', 'value', '3907968jGJeZq', 'preventDefault', 'text', 'disabled', '760041CbShGQ', 'AIzaSyDWqEQB_l4HGiRY5G6RXppH7ajelOhx0dk', 'status', 'no\x20comprendida', 'parts', 'Estoy\x20teniendo\x20dificultades\x20para\x20responder.\x20¿Podrías\x20intentar\x20formularlo\x20de\x20otra\x20manera?', '4jVJllz', '?key=', '¿Podrías\x20reformular\x20tu\x20pregunta?\x20Quiero\x20asegurarme\x20de\x20entenderte\x20bien.', 'Lo\x20mismo', '3731710vlncgG', 'userInput', 'user', 'candidates', '2KQHTud', '</div>', '1.\x20Proporciona\x20respuestas\x20contextualizadas\x20y\x20únicas\x0a', 'toggle', 'Respuesta\x20no\x20comprendida', '<strong>$1</strong>', 'content', '1809458AiRJIT', 'scrollHeight', '35810PKDaIJ', '<div\x20class=\x22bot-message\x22>', '<br>', 'innerHTML', 'getElementById', 'error', 'scrollTop', 'slice', 'length', '14050168DduQZA', 'stringify', 'application/json', 'trim', '0.\x20Puede\x20explicar\x20conceptos,\x20enseñar\x20temas\x20y\x20ofrecer\x20ejemplos\x20generales\x20para\x20ayudar\x20a\x20los\x20estudiantes\x20a\x20aprender.\x20No\x20está\x20permitido\x20resolver\x20ejercicios,\x20proporcionar\x20respuestas\x20directas\x20a\x20problemas,\x20ni\x20realizar\x20asignaciones.\x20Solo\x20puede\x20guiar\x20y\x20enseñar\x20cómo\x20abordar\x20los\x20temas.\x0a', '4.\x20Varía\x20tus\x20respuestas\x20evitando\x20repeticiones\x0a']; _0x373c = function () { return _0x2d9ec4; }; return _0x373c(); } const initialPrompt = { 'role': _0x517fd8(0xcc), 'parts': [{ 'text': 'Eres\x20un\x20tutor\x20experto\x20en\x20matemáticas,\x20español\x20e\x20inglés.\x20Reglas:\x0a' + _0x517fd8(0xe4) + _0x517fd8(0xd0) + '2.\x20Analiza\x20profundamente\x20cada\x20pregunta\x0a' + '3.\x20Si\x20no\x20entiendes\x20algo,\x20pide\x20clarificación\x0a' + _0x517fd8(0xe5) + '5.\x20Adapta\x20el\x20lenguaje\x20al\x20nivel\x20del\x20usuario' }] }; function toggleChat() { const _0xd50f99 = _0x517fd8, _0xd2fb39 = document[_0xd50f99(0xdb)]('chatContainer'); _0xd2fb39['classList'][_0xd50f99(0xd1)](_0xd50f99(0xea)); } function _0x43bf(_0x2fc16d, _0x28c9db) { const _0x373cf4 = _0x373c(); return _0x43bf = function (_0x43bf9b, _0x698761) { _0x43bf9b = _0x43bf9b - 0xc2; let _0x2626b7 = _0x373cf4[_0x43bf9b]; return _0x2626b7; }, _0x43bf(_0x2fc16d, _0x28c9db); } async function sendMessage() { const _0xe518c4 = _0x517fd8, _0x3c7240 = document['getElementById']('userInput'), _0x841687 = document['getElementById']('chatBody'), _0x1ab5f9 = _0x3c7240[_0xe518c4(0xf2)][_0xe518c4(0xe3)](); if (!_0x1ab5f9) return; isProcessing = !![], _0x3c7240['disabled'] = !![]; try { _0x841687[_0xe518c4(0xda)] += '<div\x20class=\x22user-message\x22>' + _0x1ab5f9 + '</div>', _0x3c7240['value'] = '', _0x841687['scrollTop'] = _0x841687[_0xe518c4(0xd6)]; const _0x1c8ef2 = conversationHistory['length'] > 0x4 ? conversationHistory[_0xe518c4(0xde)](-0x4) : conversationHistory, _0x244960 = [initialPrompt, ..._0x1c8ef2, { 'role': _0xe518c4(0xcc), 'parts': [{ 'text': _0x1ab5f9 }] }], _0x21c5ca = await fetch(API_URL + _0xe518c4(0xc7) + API_KEY, { 'method': 'POST', 'headers': { 'Content-Type': _0xe518c4(0xe2) }, 'body': JSON[_0xe518c4(0xe1)]({ 'contents': _0x244960, 'generationConfig': { 'temperature': 0.7, 'topP': 0.9, 'maxOutputTokens': 0x258, 'stopSequences': [_0xe518c4(0xeb), _0xe518c4(0xc9), _0xe518c4(0xf1)] } }) }); if (!_0x21c5ca['ok']) throw new Error('HTTP\x20error!\x20status:\x20' + _0x21c5ca[_0xe518c4(0xc2)]); const _0x458d2c = await _0x21c5ca['json'](), _0x23903b = _0x458d2c[_0xe518c4(0xcd)][0x0][_0xe518c4(0xd4)][_0xe518c4(0xc4)][0x0][_0xe518c4(0xf5)]; if (_0x23903b[_0xe518c4(0xee)]()[_0xe518c4(0xe8)]('no\x20entiendo')) throw new Error(_0xe518c4(0xd2)); conversationHistory[_0xe518c4(0xed)]({ 'role': _0xe518c4(0xcc), 'parts': [{ 'text': _0x1ab5f9 }] }, { 'role': 'model', 'parts': [{ 'text': _0x23903b }] }); conversationHistory[_0xe518c4(0xdf)] > 0x6 && (conversationHistory = conversationHistory[_0xe518c4(0xde)](-0x6)); const _0x49498e = _0x23903b[_0xe518c4(0xec)](/\n/g, _0xe518c4(0xd9))[_0xe518c4(0xec)](/(\d+\.)/g, _0xe518c4(0xd3)); _0x841687[_0xe518c4(0xda)] += _0xe518c4(0xd8) + _0x49498e + _0xe518c4(0xcf); } catch (_0x4568e0) { console[_0xe518c4(0xdc)](_0xe518c4(0xe6), _0x4568e0); const _0x17c563 = _0x4568e0['message'][_0xe518c4(0xe8)](_0xe518c4(0xc3)) ? _0xe518c4(0xc8) : _0xe518c4(0xc5); _0x841687['innerHTML'] += '<div\x20class=\x22bot-message\x22>' + _0x17c563 + _0xe518c4(0xcf); } finally { isProcessing = ![], _0x3c7240[_0xe518c4(0xf6)] = ![], _0x841687[_0xe518c4(0xdd)] = _0x841687[_0xe518c4(0xd6)]; } } document['getElementById'](_0x517fd8(0xcb))['addEventListener']('keypress', _0x2e25a8 => { const _0x1fa022 = _0x517fd8; _0x2e25a8['key'] === 'Enter' && !_0x2e25a8['shiftKey'] && !isProcessing && (_0x2e25a8[_0x1fa022(0xf4)](), sendMessage()); });   

        
        
        // Código original del portal
       let exams = [
            {
               id: 1,
               title: "Matemáticas College Board",
               duration: 50,
               questions: [
                   {
                       question: " If f(x) = 2x + 3, what is f(4)?",
                       options: ["11", "10", "9", "8"],
                       correct: 0,
                       image: null
                   },
                   {
                       question: " Solve for x: 3x - 5 = 16",
                       options: ["7", "8", "6", "5"],
                       correct: 0,
                       image: null
                   },
                   {
                       question: " What is the slope of the line passing through the points (2, 3) and (5, 11)?",
                       options: ["8/3", "3", "8", "11/3"],
                       correct: 0,
                       image: null
                   },
                   {
                       question: " The equation of a circle with center (0,0) and radius 5 is:",
                       options: ["x² + y² = 25", "x² + y² = 5", "x² + y² = 10", "x² + y² = 50"],
                       correct: 0,
                       image: null
                   },
                   {
                       question: " Simplify: (2x² * 3x³)",
                       options: ["5x⁵", "6x⁶", "6x⁵", "5x⁶"],
                       correct: 2,
                       image: null
                   },
                   {
                       question: " Evaluate log₂(8):",
                       options: ["2", "3", "4", "1"],
                       correct: 1,
                       image: null
                   },
                   {
                       question: " Solve: x² - 9 = 0",
                       options: ["x = 3", "x = -3", "x = 3 or x = -3", "x = 0"],
                       correct: 2,
                       image: null
                   },
                   {
                       question: " What is the derivative of f(x) = x²?",
                       options: ["2x", "x", "x²", "1"],
                       correct: 0,
                       image: null
                   },
                   {
                       question: " In a 30°-60°-90° triangle, what is the ratio of the sides?",
                       options: ["1:√3:2", "1:2:√3", "2:√3:1", "1:1:√2"],
                       correct: 0,
                       image: "assets/images/image2.png"
                   },
                   {
                       question: "Calculate: 7!",
                       options: ["5040", "720", "120", "40320"],
                       correct: 0,
                       image: null
                   },
                   {
                       question: "Evaluate: 2³ * 2⁴",
                       options: ["2⁷", "2⁸", "2¹²", "2⁶"],
                       correct: 0,
                       image: null
                   },
                   {
                       question: "Solve for y: (2y)/3 = 4",
                       options: ["y = 6", "y = 8", "y = 12", "y = 2"],
                       correct: 0,
                       image: null
                   },
                   {
                       question: "If f(x) = x² + 1, what is f(2)?",
                       options: ["5", "4", "3", "6"],
                       correct: 0,
                       image: null
                   },
                   {
                       question: "What is the distance formula between two points (x₁, y₁) and (x₂, y₂)?",
                       options: [
                           "√((x₂ - x₁)² + (y₂ - y₁)²)",
                           "(x₂ - x₁) + (y₂ - y₁)",
                           "√((x₂ - x₁) + (y₂ - y₁))",
                           "None of the above"
                       ],
                       correct: 0,
                       image: null
                   },
                   {
                       question: "For the line y = -3x + 7, what is the y-intercept?",
                       options: ["7", "-3", "0", "3"],
                       correct: 0,
                       image: null
                   },
                   {
                       question: "What is the area of a triangle with a base of 8 and a height of 5?",
                       options: ["20", "40", "30", "80"],
                       correct: 0,
                       image: null
                   },
                   {
                       question: "If sin(θ) = 1/2, then which angle (in degrees) could θ be?",
                       options: ["30°", "45°", "60°", "90°"],
                       correct: 0,
                       image: null
                   },
                   {
                       question: "Solve the proportion: 3/4 = x/8.",
                       options: ["x = 6", "x = 8", "x = 12", "x = 10"],
                       correct: 0,
                       image: null
                   },
                   {
                       question: "Find the sum of the first 5 positive integers.",
                       options: ["15", "10", "12", "20"],
                       correct: 0,
                       image: null
                   },
                   {
                       question: "If an arithmetic sequence has a first term of 3 and a common difference of 4, what is the 5th term?",
                       options: ["23", "19", "15", "21"],
                       correct: 1,
                       image: null
                   },
                   {
                       question: "Evaluate: (3²)³",
                       options: ["3⁶", "3⁵", "3⁹", "3⁸"],
                       correct: 0,
                       image: null
                   },
                   {
                       question: "What is the quadratic formula?",
                       options: [
                           "x = (-b ± √(b² - 4ac))/(2a)",
                           "x = (-b ± √(b² + 4ac))/(2a)",
                           "x = (-b ± √(b² - 4ac))/a",
                           "x = (-b ± √(4ac - b²))/(2a)"
                       ],
                       correct: 0,
                       image: null
                   },
                   {
                       question: "If two angles of a triangle are 45° and 45°, what is the measure of the third angle?",
                       options: ["90°", "45°", "60°", "120°"],
                       correct: 0,
                       image: null
                   },
                   {
                       question: "Find the greatest common divisor (GCD) of 24 and 36.",
                       options: ["6", "8", "12", "18"],
                       correct: 2,
                       image: null
                   },
                   {
                       question: "Simplify the expression: (x² - 9)/(x - 3)",
                       options: ["x + 3", "x - 3", "x² + 3", "x + 9"],
                       correct: 0,
                       image: null
                   }
               ],
               status: "pending"
            },

            {
                id: 2,
                title: "Razonamiento Matemático",
                duration: 45,
                questions: [
                    {
                        question: "A rectangle's length is twice its width. If its perimeter is 36 units, what is its area?",
                        options: ["48 square units", "72 square units", "96 square units", "108 square units"],
                        correct: 1,
                        image: null
                    },
                    {
                        question: "If 3⁽ˣ⁺¹⁾ = 27, what is the value of x?",
                        options: ["2", "3", "4", "5"],
                        correct: 0,
                        image: null
                    },
                    {
                        question: "The function h(x) = ax² + bx + c has zeros at x = -2 and x = 3. What is h(-2 + 3)?",
                        options: ["0", "1", "5", "6"],
                        correct: 1,
                        image: null
                    },
                    {
                        question: "If cos θ = 4/5, what is sin θ?",
                        options: ["3/5", "5/3", "4/3", "3/4"],
                        correct: 0,
                        image: null
                    },
                    {
                        question: "Which expression is equivalent to (x + 2)(x - 3) - (x - 1)(x + 4)?",
                        options: ["-5", "-3", "3", "5"],
                        correct: 1,
                        image: null
                    },
                    {
                        question: "A sequence has terms a₁ = 2, a₂ = 6, a₃ = 18. If this pattern continues, what is a₄?",
                        options: ["36", "54", "72", "90"],
                        correct: 0,
                        image: null
                    },
                    {
                        question: "The graph of y = f(x) is reflected over the y-axis and stretched vertically by a factor of 2. Which equation represents the new graph?",
                        options: ["y = 2f(-x)", "y = -2f(x)", "y = f(2x)", "y = 2f(x)"],
                        correct: 0,
                        image: null
                    },
                    {
                        question: "If log₃(x) = 4, what is the value of x?",
                        options: ["12", "64", "81", "256"],
                        correct: 2,
                        image: null
                    },
                    {
                        question: "The sum of two numbers is 15 and their product is 56. What is the positive difference between these numbers?",
                        options: ["1", "3", "7", "13"],
                        correct: 1,
                        image: null
                    },
                    {
                        question: "Which is equivalent to (sin²θ + cos²θ)³?",
                        options: ["0", "1", "3", "sin²θ + cos²θ"],
                        correct: 1,
                        image: null
                    },
                    {
                        question: "If f(x) = x² - 4x + 3 and g(x) = 2x - 1, find f(g(2)).",
                        options: ["3", "7", "11", "15"],
                        correct: 0,
                        image: null
                    },
                    {
                        question: "The line 3x + 2y = 12 intersects the line y = mx + b at point (2, 3). What is the value of m?",
                        options: ["-3/2", "3/2", "2/3", "-2/3"],
                        correct: 0,
                        image: null
                    },
                    {
                        question: "What is the period of the function f(x) = 3sin(2x)?",
                        options: ["π", "2π", "π/2", "π/4"],
                        correct: 0,
                        image: null
                    },
                    {
                        question: "If (x + 3)² = 16, what are all possible values of x?",
                        options: ["1 or 7", "-7 or 1", "-1 or 7", "-7 or -1"],
                        correct: 1,
                        image: null
                    },
                    {
                        question: "The expression (x⁴ - 16) can be factored as:",
                        options: ["(x² + 4)(x² - 4)", "(x² - 4)(x² + 4)", "(x + 2)(x - 2)(x² + 4)", "(x + 4)(x - 4)(x² + 4)"],
                        correct: 1,
                        image: null
                    },
                    {
                        question: "If 5ˣ = 125, then log₅(125) equals:",
                        options: ["1", "2", "3", "4"],
                        correct: 2,
                        image: null
                    },
                    {
                        question: "In triangle ABC, if sin A = 3/5 and cos B = 4/5, what is the measure of C?",
                        options: ["30°", "45°", "60°", "90°"],
                        correct: 2,
                        image: null
                    },
                    {
                        question: "The solution set of |2x - 1| > 5 is:",
                        options: ["x < -2 or x > 3", "x < 2 or x > 3", "-2 < x < 3", "-3 < x < 2"],
                        correct: 0,
                        image: null
                    },
                    {
                        question: "If f(x) = x³ - 6x² + 9x + 1, what is f'(2)?",
                        options: ["-3", "0", "3", "6"],
                        correct: 1,
                        image: null
                    },
                    {
                        question: "Which of these is equivalent to sec²θ - 1?",
                        options: ["cos²θ", "sin²θ", "tan²θ", "cot²θ"],
                        correct: 2,
                        image: null
                    },
                    {
                        question: "If the arithmetic mean of 5 numbers is 10 and their standard deviation is 2, what is the sum of their squared values?",
                        options: ["516", "520", "524", "528"],
                        correct: 2,
                        image: null
                    },
                    {
                        question: "The complex number (3 + 4i)(3 - 4i) equals:",
                        options: ["0", "9", "16", "25"],
                        correct: 3,
                        image: null
                    },
                    {
                        question: "What is the radius of convergence of the power series Σ(x/3)ⁿ?",
                        options: ["1", "2", "3", "4"],
                        correct: 2,
                        image: null
                    },
                    {
                        question: "If matrix A = [1 2; 3 4] and det(A) = -2, what is det(2A)?",
                        options: ["-4", "-8", "4", "8"],
                        correct: 1,
                        image: null
                    },
                    {
                        question: "The volume of a cone is increasing at a rate of 6π cubic units per second. If the radius is 3 units, at what rate is the height changing?",
                        options: ["2 units/sec", "3 units/sec", "4 units/sec", "6 units/sec"],
                        correct: 0,
                        image: null
                    }
                ],
                status: "pending"
            },
            {
                id: 3,
                title: "Problemas Verbales",
                duration: 25,
                questions: [
                    {
                        "question": "Juan compró 3 libros por $24.50 cada uno y 2 cuadernos por $3.75 cada uno. Si pagó con un billete de $100, ¿cuánto recibió de cambio?",
                        "options": ["$40.50", "$45.50", "$50.50", "$55.50"],
                        "correct": 0,
                        "image": null
                    },
                    {
                        "question": "En una fábrica, 15 máquinas producen 375 piezas en 5 horas. ¿Cuántas piezas producirán 12 máquinas en 8 horas?",
                        "options": ["480 piezas", "500 piezas", "480 piezas", "520 piezas"],
                        "correct": 0,
                        "image": null
                    },
                    {
                        "question": "Si 2x + 5 = 13, ¿cuál es el valor de 3x - 4?",
                        "options": ["4", "5", "6", "7"],
                        "correct": 2,
                        "image": null
                    },
                    {
                        "question": "En una tienda, el precio de una camisa aumentó un 20%. Si el precio original era $45, ¿cuál es el nuevo precio?",
                        "options": ["$50", "$54", "$56", "$58"],
                        "correct": 1,
                        "image": null
                    },
                    {
                        "question": "Un triángulo tiene un ángulo de 45° y otro de 60°. ¿Cuál es la medida del tercer ángulo?",
                        "options": ["65°", "70°", "75°", "80°"],
                        "correct": 2,
                        "image": null
                    },
                    {
                        "question": "Si 3/4 de un número es 36, ¿cuál es el número?",
                        "options": ["27", "38", "48", "54"],
                        "correct": 2,
                        "image": null
                    },
                    {
                        "question": "Un rectángulo tiene un perímetro de 24 cm y un ancho de 4 cm. ¿Cuál es su área?",
                        "options": ["24 cm²", "32 cm²", "40 cm²", "48 cm²"],
                        "correct": 2,
                        "image": null
                    },
                    {
                        "question": "Si el 15% de un número es 30, ¿cuál es el número?",
                        "options": ["150", "175", "200", "225"],
                        "correct": 2,
                        "image": null
                    },
                    {
                        "question": "En una clase, la razón de chicos a chicas es 3:5. Si hay 24 chicos, ¿cuántos estudiantes hay en total?",
                        "options": ["40", "48", "54", "64"],
                        "correct": 3,
                        "image": null
                    },
                    {
                        "question": "Un tren recorre 240 kilómetros en 3 horas. ¿Cuál es su velocidad promedio?",
                        "options": ["60 km/h", "70 km/h", "80 km/h", "90 km/h"],
                        "correct": 2,
                        "image": null
                    },
                    {
                        "question": "¿Cuál es la probabilidad de sacar un número par al lanzar un dado de 6 caras?",
                        "options": ["1/6", "1/3", "1/2", "2/3"],
                        "correct": 2,
                        "image": null
                    },
                    {
                        "question": "Si x² - 5x + 6 = 0, ¿cuál es el valor más grande de x?",
                        "options": ["2", "3", "4", "5"],
                        "correct": 1,
                        "image": null
                    },
                    {
                        "question": "Una piscina se llena en 6 horas con 2 bombas. ¿Cuánto tardará en llenarse con 3 bombas?",
                        "options": ["2 horas", "3 horas", "4 horas", "5 horas"],
                        "correct": 2,
                        "image": null
                    },
                    {
                        "question": "¿Cuál es el área de un círculo con radio de 5 cm? (Use π = 3.14)",
                        "options": ["75.5 cm²", "78.5 cm²", "81.5 cm²", "84.5 cm²"],
                        "correct": 1,
                        "image": null
                    },
                    {
                        "question": "Si 5x + 3y = 21 y 2x + y = 8, ¿cuál es el valor de x?",
                        "options": ["2", "3", "4", "5"],
                        "correct": 1,
                        "image": null
                    },
                    {
                        "question": "Un comerciante compra un artículo por $80 y lo vende con una ganancia del 25%. ¿Cuál es el precio de venta?",
                        "options": ["$95", "$100", "$105", "$110"],
                        "correct": 1,
                        "image": null
                    },
                    {
                        "question": "¿Cuál es el mínimo común múltiplo de 12 y 18?",
                        "options": ["24", "30", "36", "42"],
                        "correct": 2,
                        "image": null
                    },
                    {
                        "question": "Si un cubo tiene un volumen de 27 cm³, ¿cuál es la longitud de su arista?",
                        "options": ["2 cm", "3 cm", "4 cm", "5 cm"],
                        "correct": 1,
                        "image": null
                    },
                    {
                        "question": "En una secuencia, cada número es el doble del anterior más 1. Si el primer número es 2, ¿cuál es el cuarto número?",
                        "options": ["23", "25", "27", "29"],
                        "correct": 2,
                        "image": null
                    },
                    {
                        "question": "Un triángulo rectángulo tiene un cateto de 6 cm y una hipotenusa de 10 cm. ¿Cuál es la longitud del otro cateto?",
                        "options": ["6 cm", "8 cm", "10 cm", "12 cm"],
                        "correct": 1,
                        "image": "assets/images/image.png"
                    },
                    {
                        "question": "Si 2ˣ = 32, ¿cuál es el valor de x?",
                        "options": ["3", "4", "5", "6"],
                        "correct": 2,
                        "image": null
                    },
                    {
                        "question": "En una urna hay 5 bolas rojas y 3 azules. ¿Cuál es la probabilidad de sacar una bola roja?",
                        "options": ["3/8", "4/8", "5/8", "6/8"],
                        "correct": 2,
                        "image": null
                    },
                    {
                        "question": "Si log₁₀(x) = 2, ¿cuál es el valor de x?",
                        "options": ["20", "50", "100", "200"],
                        "correct": 2,
                        "image": null
                    },
                    {
                        "question": "Un auto viaja a 60 km/h durante 2.5 horas y luego a 80 km/h durante 1.5 horas. ¿Cuál es la distancia total recorrida?",
                        "options": ["240 km", "250 km", "260 km", "270 km"],
                        "correct": 3,
                        "image": null
                    },
                    {
                        "question": "Si (x + 2)(x - 3) = 0, ¿cuáles son los valores de x?",
                        "options": ["-2 y 3", "-3 y 2", "2 y 3", "-2 y -3"],
                        "correct": 0,
                        "image": null
                    }
                ],
                status: "pending"
            },
            {
                id: 4,
                title: "Matemática College Board 2",
                duration: 20,
                questions: [
                        {
                            question: "Juan compra 12 dulces por 30 pesos. Si al día siguiente el precio de cada dulce se incrementó a 6 pesos, ¿cuánto se ahorró Juan por dulce al comprarlos con el precio anterior?",
                            options: ["2 pesos", "3 pesos", "4 pesos", "3.5 pesos", "5 pesos"],
                            correct: 3,
                            image: null
                        },
                        {
                            question: "Si 3x+5=103, determina a qué es igual √(3x+2 ",
                            options: ["8", "9", "10", "98", "103"],
                            correct: 2,
                            image: null
                        },
                        {
                            question: "La suma de dos números enteros impares consecutivos es 104, determina el impar mayor.",
                            options: ["41", "49", "51", "53", "55"],
                            correct: 3,
                            image: null
                        },
                        {
                            question: "El largo de un rectángulo se incrementa 15% y el ancho del rectángulo se incrementa por 20%. Determina el porcentaje en que el área se incrementa.",
                            options: ["10%", "15%", "20%", "38%", "40%"],
                            correct: 3,
                            image: null
                        },
                        {
                            question: "Si se tienen dos círculos de radio 1cm y 2cm respectivamente, ¿cuál es la razón del área del primero con respecto al segundo?",
                            options: ["1:2", "1:4", "2:1", "3:1", "4:1"],
                            correct: 1,
                            image: null
                        },
                        {
                            question: "Una secretaria puede hacer 3 escritos del mismo tamaño en 4 horas. ¿Qué tiempo le llevará a la misma secretaria realizar 5 trabajos de la misma longitud?",
                            options: ["7h. 15 min.", "7h. 30 min.", "7h. 45 min.", "6h. 20 min.", "6h. 40 min."],
                            correct: 4,
                            image: null
                        },
                        {
                            question: "El precio de un traje de caballero es de 3060 pesos una vez que se ha efectuado un descuento del 15%. ¿Cuál es el precio original del traje?",
                            options: ["2601", "3519", "3600", "3825", "4000"],
                            correct: 2,
                            image: null
                        },
                        {
                            question: "En una clase de 40 estudiantes, 14 tienen ipod y 30 tienen celular. ¿Cuántos estudiantes tienen ambos aparatos, si se sabe que todos tienen al menos uno de los dos?",
                            options: ["0", "4", "6", "7", "11"],
                            correct: 1,
                            image: null
                        },
                        {
                            question: "En una urna se encuentran 20 esferas: 7 blancas, 5 rojas y 8 azules. ¿Cuál es la probabilidad que al sacar una sea azul o roja?",
                            options: ["2/5", "3/4", "13/20", "7/20", "8/20"],
                            correct: 2,
                            image: null
                        },
                        {
                            question: "El promedio de cuatro números es 30, tres de ellos son 45, 30, y 25. ¿Cuál es el número que falta?",
                            options: ["100", "35", "120", "20", "40"],
                            correct: 3,
                            image: null
                        },
                        {
                            question: "Si el promedio de dos números es 47 y uno de ellos es 24, ¿Cuál es el otro número?",
                            options: ["94", "70", "117", "23", "80"],
                            correct: 1,
                            image: null
                        },
                        {
                            question: "Las temperaturas durante una semana fueron: 32,28,25,20,25,25,27. ¿Cuál fue la media aritmética?",
                            options: ["182", "25", "32", "26", "20"],
                            correct: 3,
                            image: null
                        },
                        {
                            question: "El promedio de 4 números es 9; el promedio de otros 5 números es 8. ¿Cuál es el promedio de los 9 números?",
                            options: ["8.4", "7.6", "8", "9", "38"],
                            correct: 0,
                            image: null
                        },
                        {
                            question: "En una clase de 10 alumnos las calificaciones en Arte fueron: 7,7,7,7,7,8,8,8,8,10 ¿Cuál es la mediana?",
                            options: ["7", "8", "7.5", "8.5", "7 y 8"],
                            correct: 2,
                            image: null
                        },
                        {
                            question: "Los radios de los círculos A y B están en la razón 1:2. ¿Cuál afirmación es cierta respecto al área?",
                            options: ["El área del círculo A es la mitad del área del círculo B", "El área del círculo B es el triple del área del círculo A", "Cuatro veces el área del círculo A es igual al área del círculo B", "El área de círculo A es una quinta parte del área de círculo B", "El área del círculo A es una sexta parte del área del círculo B"],
                            correct: 2,
                            image: null
                        },
                        {
                            question: "¿Cuál representa verbalmente la expresión 2(x²-y²)?",
                            options: ["El doble de la diferencia del cuadrado de dos números", "El cuadrado de la diferencia de dos números multiplicado por 2", "El doble producto del cuadrado de la diferencia de dos números", "El doble producto de cuadrado de un número menos el cuadrado del otro", "El cuadrado de la diferencia de dos números menos el doble producto de ellos"],
                            correct: 0,
                            image: null
                        },
                        {
                            question: "¿De cuántas maneras diferentes se pueden preparar pizzas si se tienen 8 ingredientes diferentes y cada pizza lleva 2 ingredientes?",
                            options: ["28", "16", "56", "48", "4"],
                            correct: 0,
                            image: null
                        },
                        {
                            question: "En una fábrica hay 300 personas, 110 son católicos, 120 son hombres y 50 son hombres católicos. ¿Cuántas son mujeres católicas?",
                            options: ["190", "70", "120", "180", "60"],
                            correct: 4,
                            image: null
                        },
                        {
                            question: "Hay 450 alumnos de tercer año y 405 se graduarán. ¿Qué parte del total no se graduará?",
                            options: ["1/10", "1/5", "1/9", "1/8", "1/7"],
                            correct: 2,
                            image: null
                        },
                        {
                            question: "En una escuela todos reciben una de cuatro calificaciones: A, B, C y D. Si 2/5 obtienen A, 1/4 obtienen B, 1/5 obtienen C y 20 alumnos reciben D. ¿Cuántos estudiantes hay en total?",
                            options: ["30", "60", "100", "200", "400"],
                            correct: 4,
                            image: null
                        },
                        {
                            question: "Si un mes tiene 31 días y el día primero es lunes, ¿Cuáles son los días de la semana de moda en dicho mes?",
                            options: ["Lunes, martes y miércoles", "Domingo, lunes y martes", "Solo miércoles", "Sábado, domingo y lunes", "Jueves, viernes y sábado"],
                            correct: 0,
                            image: null
                        },
                        {
                            question: "En una preparatoria el club de Matemáticas tiene 15 miembros y el club de Ciencias tiene 12 miembros. Si en total 13 estudiantes pertenecen ya sea solamente a Matemáticas o solamente a Ciencias, ¿cuántos estudiantes pertenecen a ambos clubes?",
                            options: ["2", "6", "7", "12", "14"],
                            correct: 2,
                            image: null
                        },
                        {
                            question: "Si a la raíz cuadrada de la diferencia de x y 3 se le añade 5 y da como resultado 9, determina el valor de x.",
                            options: ["3", "4", "5", "16", "19"],
                            correct: 4,
                            image: null
                        },
                        {
                            question: "En un número de tres dígitos, el dígito de las centenas es el triple de las decenas y el dígito de las decenas es la mitad del dígito de las unidades. Si la suma de los tres dígitos es 12, ¿cuál es el dígito de las unidades?",
                            options: ["2", "3", "4", "6", "9"],
                            correct: 2,
                            image: null
                        },
                        {
                            question: "En una encuesta a 300 consumidores sobre productos tipo A y B (180 prefieren A, 130 prefieren B, 40 prefieren ambos), si se elige uno al azar, ¿cuál es la probabilidad de que no prefiera ningún producto?",
                            options: ["0.1", "0.2", "0.3", "0.4", "0.5"],
                            correct: 0,
                            image: null
                        }
                    ],
                status: "pending"
            },
            {
                id: 5,
                title: "Vocabulario",
                duration: 35,
                questions: [
                     {
                        "question": "¿Qué significa la palabra 'efímero'?",
                        "options": ["Duradero", "Breve", "Complejo", "Ordinario"],
                        "correct": 1,
                        "image": null
                    },
                    {
                        "question": "¿Cuál es el sinónimo de 'perspicaz'?",
                        "options": ["Ingenuo", "Sagaz", "Tímido", "Irreflexivo"],
                        "correct": 1,
                        "image": null
                    },
                    {
                        "question": "¿Qué palabra es un antónimo de 'tedioso'?",
                        "options": ["Aburrido", "Dinámico", "Monótono", "Pesado"],
                        "correct": 1,
                        "image": null
                    },
                    {
                        "question": "¿Cuál es el significado de 'paradigma'?",
                        "options": ["Ejemplo", "Problema", "Teoría", "Hipótesis"],
                        "correct": 0,
                        "image": null
                    },
                    {
                        "question": "¿Qué significa la palabra 'ineludible'?",
                        "options": ["Evadible", "Inevitable", "Flexible", "Opcional"],
                        "correct": 1,
                        "image": null
                    },
                    {
                        "question": "¿Cuál es el sinónimo de 'reverberar'?",
                        "options": ["Reflejarse", "Absorber", "Apagar", "Callar"],
                        "correct": 0,
                        "image": null
                    },
                    {
                        "question": "¿Qué significa 'lacónico'?",
                        "options": ["Elocuente", "Breve", "Sofisticado", "Desorganizado"],
                        "correct": 1,
                        "image": null
                    },
                    {
                        "question": "¿Cuál es el antónimo de 'arduo'?",
                        "options": ["Fácil", "Intenso", "Duro", "Complicado"],
                        "correct": 0,
                        "image": null
                    },
                    {
                        "question": "¿Qué significa 'discrepancia'?",
                        "options": ["Acuerdo", "Diferencia", "Afinidad", "Coincidencia"],
                        "correct": 1,
                        "image": null
                    },
                    {
                        "question": "¿Qué palabra es un sinónimo de 'ostentoso'?",
                        "options": ["Modesto", "Sencillo", "Lujoso", "Humilde"],
                        "correct": 2,
                        "image": null
                    },
                    {
                        "question": "¿Cuál es el significado de 'frugal'?",
                        "options": ["Abundante", "Económico", "Derrochador", "Generoso"],
                        "correct": 1,
                        "image": null
                    },
                    {
                        "question": "¿Qué significa la palabra 'ambiguo'?",
                        "options": ["Claro", "Confuso", "Inequívoco", "Específico"],
                        "correct": 1,
                        "image": null
                    },
                    {
                        "question": "¿Cuál es el sinónimo de 'inerte'?",
                        "options": ["Activo", "Inmóvil", "Vibrante", "Productivo"],
                        "correct": 1,
                        "image": null
                    },
                    {
                        "question": "¿Qué significa 'perpetuar'?",
                        "options": ["Olvidar", "Prolongar", "Detener", "Interrumpir"],
                        "correct": 1,
                        "image": null
                    },
                    {
                        "question": "¿Qué palabra es un antónimo de 'benevolente'?",
                        "options": ["Amable", "Hostil", "Bondadoso", "Compasivo"],
                        "correct": 1,
                        "image": null
                    },
                    {
                        "question": "¿Qué significa 'cauteloso'?",
                        "options": ["Descuidado", "Prudente", "Imprudente", "Riesgoso"],
                        "correct": 1,
                        "image": null
                    },
                    {
                        "question": "¿Cuál es un sinónimo de 'esporádico'?",
                        "options": ["Frecuente", "Ocasional", "Continuo", "Persistente"],
                        "correct": 1,
                        "image": null
                    },
                    {
                        "question": "¿Qué significa la palabra 'euforia'?",
                        "options": ["Tristeza", "Alegría extrema", "Indiferencia", "Calma"],
                        "correct": 1,
                        "image": null
                    },
                    {
                        "question": "¿Qué significa 'ostentar'?",
                        "options": ["Esconder", "Mostrar", "Evitar", "Renunciar"],
                        "correct": 1,
                        "image": null
                    },
                    {
                        "question": "¿Cuál es el antónimo de 'voraz'?",
                        "options": ["Insaciable", "Moderado", "Hambriento", "Apresurado"],
                        "correct": 1,
                        "image": null
                    },
                    {
                        "question": "¿Qué significa 'oneroso'?",
                        "options": ["Fácil", "Costoso", "Ligero", "Gratuito"],
                        "correct": 1,
                        "image": null
                    },
                    {
                        "question": "¿Cuál es un sinónimo de 'prodigioso'?",
                        "options": ["Común", "Extraordinario", "Normal", "Ordinario"],
                        "correct": 1,
                        "image": null
                    },
                    {
                        "question": "¿Qué significa 'tenaz'?",
                        "options": ["Indeciso", "Persistente", "Dudoso", "Débil"],
                        "correct": 1,
                        "image": null
                    },
                    {
                        "question": "¿Qué palabra es un antónimo de 'precario'?",
                        "options": ["Estable", "Inseguro", "Frágil", "Vulnerable"],
                        "correct": 0,
                        "image": null
                    },
                    {
                        "question": "¿Qué significa 'impávido'?",
                        "options": ["Asustado", "Valiente", "Tímido", "Dudoso"],
                        "correct": 1,
                        "image": null
                    }
                ],
                status: "pending"
            },
            {
                id: 6,
                title: "Comprensión de Lectura",
                duration: 40,
                questions: [
                   {
                        "question": "¿Qué palabra describe mejor el significado de 'mito' en el contexto de la lectura sobre los alimentos calentados al microondas?",
                        "options": ["Historia de héroes y deidades", "Una invención literaria antigua", "Creencia que altera la verdad", "Una historia muy tradicional"],
                        "correct": 2,
                        "image": "assets/images/alimentos_microondas.png"
                    },
                    {
                        "question": "Según la lectura sobre el microondas, ¿qué método reduce los nutrientes de los alimentos?",
                        "options": ["Cocción al vapor", "Hervir en agua", "Uso de microondas", "Todos los métodos de cocción"],
                        "correct": 3,
                        "image": null
                    },
                    {
                        "question": "¿Cuál es el principal antioxidante del té mencionado en la lectura sobre la estevia?",
                        "options": ["Quercetina", "Glicósidos del esteviol", "Vitamina C", "Ácido fólico"],
                        "correct": 0,
                        "image": "assets/images/lectura_estevia.png"
                    },
                    {
                        "question": "En la lectura sobre la ópera renacentista, ¿quién escribió 'Dafne'?",
                        "options": ["Ottavio Rinuccini", "Giovanni Bardi", "Jacopo Peri", "Giulio Caccini"],
                        "correct": 2,
                        "image": "assets/images/opera_renacentista.png"
                    },
                    {
                        "question": "¿Según la lectrura la palabra (arca)línea 2 , se refiere a...?",
                        "options": ["una caja de madera con cerradura", "una nave o embarcación", "un lugar dónde se guarda lo valioso", "un sepulcro o"],
                        "correct": 1,
                        "image": "assets/images/niña_imaginaba.png"
                    },
                    {
                        "question": "Según la lectura, ¿cuál es el porcentaje de hogares en 2014 que clasificaron plástico como residuo?",
                        "options": ["20.86%", "31.48%", "12.68%", "25.75%"],
                        "correct": 1,
                        "image": "assets/images/residuo_organico.png"
                    },
                    {
                        "question": "¿Qué significa el término 'ergogenia' en el contexto de la lectura sobre el café?",
                        "options": ["Sustancias que aumentan el rendimiento físico", "Métodos de cultivo de café", "Efectos negativos del café", "Pruebas científicas sobre cafeína"],
                        "correct": 0,
                        "image": "assets/images/cafe.png"
                    },
                    {
                        "question": "En la lectura sobre residuos, ¿qué tipo de material fue el más clasificado en los hogares?",
                        "options": ["Vidrio", "Papel-cartón", "Plástico", "Orgánicos"],
                        "correct": 2,
                        "image": "assets/images/residuo_organico.png"
                    },
                   
                    {
                        "question": "¿Qué palabra puede sustituir apropiadamente a 'memoria' en la lectura sobre la anécdota del hotel?",
                        "options": ["Recuerdo", "Estudio", "Cerebro", "Estrategia"],
                        "correct": 0,
                        "image": "assets/images/la_memoria.png"
                    },
                    {
                        "question": "¿Cuál era la principal función de la CNC mencionada en la lectura?",
                        "options": ["Apoyar políticas presidenciales", "Recaudar impuestos", "Promover la agricultura", "Generar empleos"],
                        "correct": 0,
                        "image": "assets/images/funcion_CNC.png"
                    },
                    {
                        "question": "En la lectura sobre la estevia, ¿qué compuesto está directamente relacionado con su capacidad antioxidante?",
                        "options": ["Ácido fólico", "Vitamina C", "Glicósidos del esteviol", "Edulcorantes refinados"],
                        "correct": 2,
                        "image": "assets/images/lectura_estevia.png"
                    },
                    {
                        "question": "Según la lectura, ¿qué resultado se obtuvo al consumir más de 5 tazas de café al día en el experimento?",
                        "options": ["Escuchar música inexistente", "Mayor percepción del cansancio", "Mejora en habilidades motoras", "Reducción del estrés"],
                        "correct": 0,
                        "image": "assets/images/cafe.png"
                    },
                    {
                        "question": "En la lectura sobre residuos, ¿qué beneficio tiene el compostaje?",
                        "options": ["Generar ingresos", "Producir abono natural", "Incrementar los residuos sólidos", "Reducir el reciclaje"],
                        "correct": 1,
                        "image": "assets/images/residuo_organico.png"
                    },
                   
                    {
                        "question": "En la lectura sobre el códice Voynich, ¿quién lo adquirió en 1912?",
                        "options": ["John Dee", "Wilfrid Voynich", "Rodolfo II de Habsburgo", "Hans Peter Kraus"],
                        "correct": 1,
                        "image": "assets/images/codice_voniche.png"
                    },
                    {
                        "question": "Según la lectura, ¿qué caracteriza a los glicósidos del esteviol?",
                        "options": ["Son altamente calóricos", "Tienen propiedades antioxidantes", "Provienen del azúcar de mesa", "Son menos dulces que la sacarosa"],
                        "correct": 1,
                        "image": "assets/images/lectura_estevia.png"
                    },
                    {
                        "question": "En la lectura sobre residuos, ¿qué porcentaje del papel-cartón fue clasificado en 2014?",
                        "options": ["12.68%", "20.86%", "31.48%", "25.50%"],
                        "correct": 1,
                        "image": "assets/images/residuo_organico.png"
                    },
                    {
                        "question": "En la lectura sobre la ópera renacentista, ¿qué grupo contribuyó al desarrollo de la teoría del teatro musical?",
                        "options": ["La familia Medici", "La Camerata de Giovanni Bardi", "El círculo de Galileo Galilei", "El Consejo de Florencia"],
                        "correct": 1,
                        "image": "assets/images/opera_renacentista.png"
                    },
                    {
                        "question": "Según la lectura, ¿qué proceso ocurre con las proteínas cuando se calientan?",
                        "options": ["Se enfrían rápidamente", "Se desnaturalizan", "Se fortalecen", "Se vuelven líquidas"],
                        "correct": 1,
                        "image": "assets/images/alimentos_microondas.png"
                    },
                    {
                        "question": "¿Qué se perdió en la obra 'Dafne' según la lectura sobre la ópera?",
                        "options": ["El libreto", "La música", "El título original", "El reconocimiento"],
                        "correct": 1,
                        "image": "assets/images/opera_renacentista.png"
                    },
                    {
                        "question": "En la lectura sobre el café, ¿qué efecto tiene la cafeína en el rendimiento físico?",
                        "options": ["Aumenta el cansancio", "Reduce la percepción del esfuerzo", "Incrementa el estrés", "Disminuye la tolerancia al ejercicio"],
                        "correct": 1,
                        "image": "assets/images/cafe.png"
                    },
                    {
                        "question": "Según la lectura, ¿qué caracteriza a los residuos inorgánicos?",
                        "options": ["Provienen de organismos vivos", "Son reciclables", "Se descomponen rápidamente", "Provienen de procesos industriales"],
                        "correct": 3,
                        "image": "assets/images/residuo_organico.png"
                    },
                    {
                        "question": "En la lectura sobre la memoria, ¿por qué el personaje pide que le recuerden el número de su habitación?",
                        "options": ["Es una tradición del hotel", "Tiene mala memoria", "No confía en el personal", "Olvidó la llave"],
                        "correct": 1,
                        "image": "assets/images/la_memoria.png"
                    },
                    {   "image": "assets/images/ciencia_ficcion.png",
                        "question": "En la lectura sobre ficción literaria, ¿qué propósito tiene la literatura según el autor?",
                        "options": ["Imitar la realidad exacta", "Crear experiencias emocionales", "Criticar exclusivamente lo social", "Estudiar hechos históricos"],
                        "correct": 1,
                        
                    }
                ],
                status: "pending"
            }
        ];
        

        let grades = [];
        let currentExam = null;
        let timeLeft = 0;
        let timerInterval = null;

        // Obtener IP del usuario
        async function getClientIP() {
            try {
                const response = await fetch('https://api.ipify.org?format=json');
                const data = await response.json();
                return data.ip;
            } catch (error) {
                return 'unknown-ip';
            }
        }

        // Cargar progreso guardado
        function loadProgress() {
            const savedData = localStorage.getItem('studentProgress');
            if (savedData) {
                try {
                    const data = JSON.parse(savedData);
                    grades = data.grades || [];
                    exams = exams.map(exam => ({
                        ...exam,
                        status: data.completedExams.includes(exam.id) ? 'completed' : 'pending'
                    }));
                } catch (e) {
                    console.error('Error loading progress:', e);
                }
            }
        }

        // Guardar progreso
        // Función MODIFICADA con la nueva validación
        async function saveProgress() {
            // Nueva validación para limpiar el localStorage si no hay calificaciones
            if (grades.length === 0) {
                localStorage.removeItem('studentProgress');
                return;
            }

            // Mantenemos toda la lógica original de guardado
            const progressData = {
                grades: grades.map(grade => ({
                    ...grade,
                    date: new Date(grade.date).toISOString()
                })),
                completedExams: exams.filter(e => e.status === 'completed').map(e => e.id),
                ip: await getClientIP(),
                timestamp: new Date().toISOString()
            };

            localStorage.setItem('studentProgress', JSON.stringify(progressData));
        }

        // Navegación
        function handleNavigation() {
            const hash = window.location.hash || "#dashboard";
            $('.nav-link').removeClass('active');
            $(`a[href="${hash}"]`).addClass('active');
            $('.section').removeClass('active');
            $(hash).addClass('active');
        }

        // Dashboard
        function initDashboard() {
            $('#upcoming-exams').html(exams.filter(e => e.status === 'pending')
                .map(e => `<li class="list-group-item">${e.title} - ${e.duration} minutos</li>`).join(''));

            new Chart($('#performanceChart'), {
                type: 'line',
                data: {
                    labels: grades.map(g => new Date(g.date).toLocaleDateString()),
                    datasets: [{
                        label: 'Calificaciones',
                        data: grades.map(g => g.score),
                        borderColor: '#3498db'
                    }]
                }
            });
        }

        // Cargar exámenes
        function loadExams() {
            $('#exam-list').html(exams.map(exam => `
                <div class="list-group-item d-flex justify-content-between align-items-center">
                    <div>
                        <h5>${exam.title}</h5>
                        <small>Duración: ${exam.duration} minutos</small>
                        ${exam.status === 'completed' ?
                    '<div class="text-success mt-1"><i class="fas fa-check"></i> Completado</div>' : ''}
                    </div>
                    <button class="btn btn-primary btn-sm" 
                            ${exam.status === 'completed' ? 'disabled' : ''}
                            onclick="startExam(${exam.id})">
                        ${exam.status === 'completed' ? 'Examen Entregado' : 'Iniciar Examen'}
                    </button>
                </div>
            `).join(''));
        }

        // Iniciar examen
       function startExam(examId) {
            currentExam = exams.find(e => e.id === examId);
            timeLeft = currentExam.duration * 60;

            // Mostrar preguntas con imágenes opcionales
            $('#examQuestions').html(`
        <div class="student-info mb-4">
            <div class="row">
                <div class="col-md-6">
                    <label for="firstName" class="form-label">Nombre</label>
                    <input type="text" class="form-control" id="firstName" required>
                </div>
                <div class="col-md-6">
                    <label for="lastName" class="form-label">Apellido</label>
                    <input type="text" class="form-control" id="lastName" required>
                </div>
            </div>
        </div>
        ${currentExam.questions.map((q, index) => `
            <div class="question-card">
                <h6>Pregunta ${index + 1}: ${q.question}</h6>
                ${q.image ? `<img src="${q.image}" alt="Imagen de la pregunta" class="img-fluid mb-3">` : ""}
                ${q.options.map((o, i) => `
                    <div class="form-check">
                        <input class="form-check-input" type="radio" name="q${index}" id="q${index}o${i}" value="${i}">
                        <label class="form-check-label" for="q${index}o${i}">
                            ${o}
                        </label>
                    </div>
                `).join('')}
            </div>
        `).join('')}
       
    `);

            // Mostrar temporizador
            $('.timer').text(
                `${Math.floor(timeLeft / 60).toString().padStart(2, '0')}:${(timeLeft % 60).toString().padStart(2, '0')}`
            ).show();

            $('#examModal').modal('show'); // Mostrar modal del examen
            startTimer(); // Iniciar el temporizador
        }



        // Temporizador
        function startTimer() {
            clearInterval(timerInterval);
            timerInterval = setInterval(() => {
                timeLeft--;
                $('.timer').text(
                    `${Math.floor(timeLeft / 60).toString().padStart(2, '0')}:${(timeLeft % 60).toString().padStart(2, '0')}`
                );
                if (timeLeft <= 0) submitExam();
            }, 1000);
        }

        // Entregar examen
        async function submitExam() {
            const firstName = $('#firstName').val().trim();
            const lastName = $('#lastName').val().trim();

            if (!firstName || !lastName) {
                alert('Por favor ingresa tu nombre y apellido.');
                return;
            }

            clearInterval(timerInterval);

            let score = 0;
            const results = currentExam.questions.map((q, index) => {
                const selected = $(`input[name="q${index}"]:checked`).val();
                const isCorrect = parseInt(selected) === q.correct;
                if (isCorrect) score++;
                return {
                    question: q.question,
                    userAnswer: q.options[selected] || "Sin responder",
                    correctAnswer: q.options[q.correct],
                    isCorrect: isCorrect
                };
            });

            const finalScore = (score / currentExam.questions.length * 100).toFixed(1);
            const timeUsed = `${Math.floor((currentExam.duration * 60 - timeLeft) / 60)}:${(currentExam.duration * 60 - timeLeft) % 60}`.padStart(2, '0');

            showResults(results, finalScore, timeUsed, firstName, lastName);
            await saveGrade(firstName, lastName, finalScore);
        }

        // Mostrar resultados
        function showResults(results, score, timeUsed, firstName, lastName) {
            $('#finalScore').text(score);
            $('#timeUsed').text(timeUsed);
            $('#studentName').text(`${firstName} ${lastName}`);
            $('#resultsDetails').html(results.map((r, i) => `
                <div class="question-card ${r.isCorrect ? 'correct-answer' : 'incorrect-answer'}">
                    <h6>Pregunta ${i + 1}: ${r.question}</h6>
                    <p>Tu respuesta: ${r.userAnswer}</p>
                    <p>Respuesta correcta: ${r.correctAnswer}</p>
                </div>
            `).join(''));
            $('#examModal').modal('hide');
            $('#resultsModal').modal('show');
        }

        // Guardar calificación
        async function saveGrade(firstName, lastName, score) {
            grades.push({
                firstName,
                lastName,
                exam: currentExam.title,
                score,
                date: new Date().toISOString(),
                ip: await getClientIP()
            });

            currentExam.status = 'completed';
            await saveProgress();
            updateGrades();
        }

        // Actualizar tabla
        function updateGrades() {
            $('#grades-table').html(grades.map(g => `
                <tr>
                    <td>${g.exam}</td>
                    <td>${g.score}%</td>
                    <td>${new Date(g.date).toLocaleDateString()}</td>
                </tr>
            `).join(''));
        }

        // Generar PDF
        function generatePDF() {
            if (grades.length === 0) {
                alert('No hay calificaciones para exportar.');
                return;
            }

            const { jsPDF } = window.jspdf;
            const doc = new jsPDF();
            const lastIP = grades[grades.length - 1]?.ip || 'No registrada';

            doc.setFontSize(18);
            doc.text('Historial de Calificaciones', 14, 22);
            doc.setFontSize(12);
            doc.text(`Última IP registrada: ${lastIP}`, 14, 28);

            doc.autoTable({
                head: [['Nombre', 'Apellido', 'Examen', 'Calificación', 'Fecha']],
                body: grades.map(g => [
                    g.firstName,
                    g.lastName,
                    g.exam,
                    `${g.score}%`,
                    new Date(g.date).toLocaleDateString()
                ]),
                startY: 35,
                theme: 'grid',
                headStyles: { fillColor: [41, 128, 185], textColor: 255 },
                margin: { horizontal: 10 }
            });

            doc.save('calificaciones.pdf');
        }

        // Inicialización
        $(document).ready(() => {
            loadProgress();
            handleNavigation();
            initDashboard();
            loadExams();
            updateGrades();

            $(window).on('hashchange', handleNavigation);
            $('#examModal').on('hidden.bs.modal', () => {
                clearInterval(timerInterval);
                $('.timer').hide();
            });
        });

        // Mensaje inicial del chat
        window.onload = () => {
            document.getElementById('chatBody').innerHTML = `
                <div class="bot-message">
                    ¡Hola! Soy tu tutor interactivo 🎓<br>
                    Puedes preguntarme sobre:
                    <ul>
                        <li>Matemáticas: ecuaciones, fórmulas, problemas, etc...</li>
                        <li>Español: gramática, redacción, literatura, etc...</li>
                        <li>Inglés: vocabulario, gramática, traducciones, etc...</li>
                    </ul>
                    ¿En qué puedo ayudarte hoy?
                </div>
            `;
        };

        $(document).ready(() => {
            loadProgress();
            handleNavigation();
            initDashboard();
            loadExams();
            updateGrades();

            $(window).on('hashchange', handleNavigation);
            $('#examModal').on('hidden.bs.modal', () => {
                clearInterval(timerInterval);
                $('.timer').hide();
            });
        });
    </script>
 

</body>

</html>
